<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-JavaDocs/DSA/data-structure-多维数据索引" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">data-structure-多维数据索引 | Analysis Project</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://Swagger-Ranger.github.io/analysis-project/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://Swagger-Ranger.github.io/analysis-project/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://Swagger-Ranger.github.io/analysis-project/docs/JavaDocs/DSA/data-structure-多维数据索引"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="data-structure-多维数据索引 | Analysis Project"><meta data-rh="true" name="description" content="多维数据查询"><meta data-rh="true" property="og:description" content="多维数据查询"><link data-rh="true" rel="icon" href="/analysis-project/img/apachecassandra-color.svg"><link data-rh="true" rel="canonical" href="https://Swagger-Ranger.github.io/analysis-project/docs/JavaDocs/DSA/data-structure-多维数据索引"><link data-rh="true" rel="alternate" href="https://Swagger-Ranger.github.io/analysis-project/docs/JavaDocs/DSA/data-structure-多维数据索引" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://Swagger-Ranger.github.io/analysis-project/docs/JavaDocs/DSA/data-structure-多维数据索引" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/analysis-project/blog/rss.xml" title="Analysis Project RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/analysis-project/blog/atom.xml" title="Analysis Project Atom Feed"><link rel="stylesheet" href="/analysis-project/assets/css/styles.460af289.css">
<script src="/analysis-project/assets/js/runtime~main.37b8cbe4.js" defer="defer"></script>
<script src="/analysis-project/assets/js/main.34cc3d81.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/analysis-project/"><div class="navbar__logo"><img src="/analysis-project/img/apachecassandra-color.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/analysis-project/img/apachecassandra-color.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/analysis-project/docs/projectDesign/whatIs">All for analysis</a><a class="navbar__item navbar__link" href="/analysis-project/docs/middleware/disruptor">Middlewares</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/analysis-project/docs/category/juc">Codes</a><a class="navbar__item navbar__link" href="/analysis-project/docs/DevOps/JavaOptimizing">DevOps</a><a class="navbar__item navbar__link" href="/analysis-project/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/analysis-project/about">关于作者</a><a href="https://github.com/Swagger-Ranger/analysis-project" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/analysis-project/docs/category/juc">JUC</a><button aria-label="展开侧边栏分类 &#x27;JUC&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/analysis-project/docs/category/dsa">DSA</a><button aria-label="折叠侧边栏分类 &#x27;DSA&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/analysis-project/docs/JavaDocs/DSA/algo-共识算法-raft">algo-共识算法-Raft</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/analysis-project/docs/JavaDocs/DSA/data-structure-哈希">data-structure-哈希</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/analysis-project/docs/JavaDocs/DSA/data-structure-位图">data-structure-位图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/analysis-project/docs/JavaDocs/DSA/data-structure-多维数据索引">data-structure-多维数据索引</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/analysis-project/docs/JavaDocs/DSA/data-structure-跳表">data-structure-跳表</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/analysis-project/docs/category/sa">SA</a><button aria-label="展开侧边栏分类 &#x27;SA&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/analysis-project/docs/JavaDocs/JDK/泛型">JDK</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/analysis-project/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/analysis-project/docs/category/dsa"><span itemprop="name">DSA</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">data-structure-多维数据索引</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>data-structure-多维数据索引</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多维数据查询">多维数据查询<a href="#多维数据查询" class="hash-link" aria-label="多维数据查询的直接链接" title="多维数据查询的直接链接">​</a></h2>
<p>多维数据模型将数据组织为一个立方体（通常称为数据立方体），每个维度代表数据集中的一个分析视角。多维数据集通常在数据仓库和在线分析处理（OLAP）系统中使用，用于支持复杂的数据分析任务。</p>
<p>多维数据查询特定：</p>
<ul>
<li>
<p><strong>切片（Slicing）</strong>：切片操作是从多维数据集中选择一个特定的维度值，从而减少数据集的维度。例如，从一个包含时间、产品和地区三个维度的数据集中选择一个特定的时间段。</p>
</li>
<li>
<p><strong>切块（Dicing）</strong>：切块操作是选择多维数据集的一个子集，通过指定多个维度的值范围。例如，从一个包含时间、产品和地区三个维度的数据集中选择某个时间段、某些产品和某些地区的数据。<em>切块相比切片有更细的维度，Dicing单词的意思就是切成丁</em>。</p>
</li>
<li>
<p><strong>钻取（Drill-Down）</strong>：钻取操作是从更高层次的维度数据向更低层次钻取。例如，从年层次钻取到季度或月层次，以查看更详细的数据。</p>
</li>
<li>
<p><strong>上卷（Roll-Up）</strong>：上卷操作是从更低层次的维度数据向更高层次汇总。例如，将月数据汇总到季度或年层次。</p>
</li>
<li>
<p><strong>旋转（Pivoting）</strong>：旋转操作是改变数据立方体的维度视图，以便从不同角度查看数据。例如，将产品维度和地区维度交换。</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="多维数据结构">多维数据结构<a href="#多维数据结构" class="hash-link" aria-label="多维数据结构的直接链接" title="多维数据结构的直接链接">​</a></h2>
<p>多数支持多维数据查询的数据结构归于以下两类之一：</p>
<p>1、类散列表方法；</p>
<p>2、类树方法；</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="多维数据散列结构">多维数据散列结构<a href="#多维数据散列结构" class="hash-link" aria-label="多维数据散列结构的直接链接" title="多维数据散列结构的直接链接">​</a></h3>
<p>一种方法称为“网格文件”，它通常不是按维来“散列”值，而是通过<strong>排序该维的值</strong>来划分该维；另一种方法是“分段散列”，它确实<strong>散列各维</strong>，且每一维都影响桶号。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="网格文件">网格文件<a href="#网格文件" class="hash-link" aria-label="网格文件的直接链接" title="网格文件的直接链接">​</a></h4>
<p>在多维数据查询和分析中，网格文件（Grid File）是一种用于管理多维数据索引和存储的技术。网格文件是一种多维索引结构，用于在数据库中存储和检索多维数据。它将数据空间划分为一个个小的网格单元（grid cells），每个单元包含一些数据点。这种方法允许快速定位和访问多维数据中的特定区域。</p>
<blockquote>
<p>网格文件其实就类似于多维数组，数组中的每个点就是个数据存储块，可以存储多个数据，并且数据库在范围上还可以分裂并调整整个多维数组；并且每个维度都是按照数据特定排好序了的，这样能保证查询速度和范围查询。</p>
</blockquote>
<p><strong>网络文件结构</strong>：</p>
<ul>
<li>网格文件将数据空间划分为多个维度，每个维度按照一定的顺序分割成若干区间，形成一个类似多维数组的结构。</li>
<li>每个维度上的分割点被存储在分割表中，这些分割点确定了网格单元的边界。</li>
<li>每个维度上的分割点按顺序排列，这样可以确保在进行查询时，能够快速确定数据所在的网格单元，从而提高查询速度。这种有序排列也使得范围查询（range queries）更为高效，因为可以迅速定位需要访问的网格单元范围。</li>
</ul>
<p><strong>数据存储块</strong>：</p>
<ul>
<li>每个网格单元（类似多维数组中的一个点）对应一个数据存储块（data block），该块中可以存储多个数据记录。</li>
<li>数据块可以动态扩展或分裂，以适应数据插入和存储需求。当某个网格单元中的数据块满了时，可以进行分裂，将数据重新分配到新的网格单元中。分裂可能会影响到相  邻的网格单元，并且需要更新网格目录。通过动态调整网格单元和数据块，网格文件可以适应数据的增长和变化，保持查询效率。</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="示例">示例<a href="#示例" class="hash-link" aria-label="示例的直接链接" title="示例的直接链接">​</a></h5>
<p>如下是一个二维的数据</p>
<table><thead><tr><th style="text-align:left">年龄</th><th style="text-align:left">薪资</th></tr></thead><tbody><tr><td style="text-align:left">25</td><td style="text-align:left">60</td></tr><tr><td style="text-align:left">25</td><td style="text-align:left">400</td></tr><tr><td style="text-align:left">30</td><td style="text-align:left">260</td></tr><tr><td style="text-align:left">45</td><td style="text-align:left">60</td></tr><tr><td style="text-align:left">45</td><td style="text-align:left">350</td></tr><tr><td style="text-align:left">50</td><td style="text-align:left">75</td></tr><tr><td style="text-align:left">50</td><td style="text-align:left">100</td></tr><tr><td style="text-align:left">50</td><td style="text-align:left">120</td></tr><tr><td style="text-align:left">50</td><td style="text-align:left">275</td></tr><tr><td style="text-align:left">60</td><td style="text-align:left">260</td></tr><tr><td style="text-align:left">70</td><td style="text-align:left">110</td></tr><tr><td style="text-align:left">85</td><td style="text-align:left">140</td></tr></tbody></table>
<div style="text-align:center;width:100%"><img src="/analysis-project/img/data-structure/gridFile.png" alt="image" style="max-width:50%;height:auto;display:block;margin:0 auto"></div>
<div style="text-align:center;width:100%"><img src="/analysis-project/img/data-structure/gridFile1.png" alt="image" style="max-width:50%;height:auto;display:block;margin:0 auto"></div>
<p>特别注意的点：</p>
<ul>
<li>
<p><strong>文件查找</strong>：根据查询条件确定需要访问的网格单元，查找对应的数据块，然后从数据块中检索满  足条件的数据记录。</p>
</li>
<li>
<p><strong>维度索引</strong>：网格文件在每一维上的条目数量可能非常大，如果那样的话，我们必须为每一维建立一个索引。索引的搜索码是该维分割值的集合。</p>
</li>
<li>
<p><strong>文件插入</strong>：插入操作同样也遵循查找记录的过程（即多个维度来确定桶的位置），并将新记录放到查找到的桶中。当桶中有足够的空间时，直接插入即可；如果桶中没有空间，可以用如下两种方法来解决这个问题。</p>
</li>
<li>
<p>1、按需给桶增加溢出块；</p>
</li>
<li>
<p>2、 通过增加或移动网格线来重组结构；即维度的间隔不是均匀的分布的</p>
</li>
<li>
<p><strong>溢出块</strong>：上图中使用的桶数组维数和网格文件的维数相同，均为2。横向表示年龄，纵向表示薪水。而且在上面的例子中没有桶超过两个记录，因此不需要溢出块。</p>
</li>
<li>
<p>溢出块就是当数据块中的数据无法再放入时，增加的存储空间，这些溢出块链接到原始数据块（通常通过链表或指针的方式）。</p>
</li>
<li>
<p>在查询时，首先访问原始数据块。如果需要访问的数据在原始数据块中找不到，还需要检查溢出块中的数据。</p>
</li>
<li>
<p>溢出块好处是：简单易实现和动态扩展不需要预先分配过多的存储空间</p>
</li>
<li>
<p>溢出块坏处是：当溢出块链条较长时查询效率会显著降低，溢出块的链条增加了数据管理的复杂性，需要维护这些链条的连接和完整性</p>
</li>
<li>
<p><strong>非均匀间隔</strong>：每个维度可以根据数据的实际分布情况进行划分，间隔可以是非均匀的。这意味着在一个维度上，网格单元的大小可以不同，取决于数据分布的密度和查询需求</p>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="网格文件的优点">网格文件的优点<a href="#网格文件的  优点" class="hash-link" aria-label="网格文件的优点的直接链接" title="网格文件的优点的直接链接">​</a></h5>
<ul>
<li><strong>高效的多维查询</strong>：通过将数据空间划分为较小的网格单元，网格文件可以快速定位查询范围内的数据，适用于高维数据的快速查询。</li>
<li><strong>动态调整</strong>：网格文件可以根据数据的分布动态调整网格划分，以适应数据的变化。</li>
<li><strong>简单实现</strong>：相比一些复杂的多维索引结构（如R树），网格文件的实现相对简单。</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="网格文件的缺点">网格文件的缺点<a href="#网格文件的缺点" class="hash-link" aria-label="网格文件的缺点的直接链接" title="网格文件的缺点的直接链接">​</a></h5>
<ul>
<li><strong>空间效率</strong>：当数据分布不均匀时，某些网格单元可能非常稀疏，导致存储空间浪费。</li>
<li><strong>处理高维数据的扩展性</strong>：随着维度数增加，网格单元数量呈指数级增长，可能导致目录变得非常大，不适合极高维度的数据。</li>
</ul>
<blockquote>
<p>所以使用网格文件的场景多为：数据分布很好，且数据文件本身又不太大</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="分段散列">分段散列<a href="#分段散列" class="hash-link" aria-label="分段散列的直接链接" title="分段散列的直接链接">​</a></h4>
<p>分段散列其实就是将多个维度的key，按照预定的划分，比如总的hash位数是n，则key1对应1-2位、key2对应2-5位、key3对应5-10位...这样将多维的数据分到同一个hash值上，然后通过hash值来定位数据块。</p>
<p>比如：如果我们有一个桶数目为 10位 （注意是10位，不是10个）的散列表（1024个桶）。我们把4位分给属性a（假设属性值为A），剩下的6位分给属性b（假设属性值为B）。如果 ha(A)=0101, hb(B)=111000，那么对应的桶号为两个二进制序列拼接的 <code>0101111000</code>。</p>
<p><strong>优点</strong>：精确查询效率高</p>
<ul>
<li>多段哈希能够快速定位到具体的段，并通过哈希值直接找到对应的数据记录，这使得精确查询（如给定具体的多维键值查询）非常高效。</li>
<li>这种高效性来源于哈希表的O(1)查询时间和分段的独立管理。</li>
</ul>
<p><strong>缺点</strong>：范围查询效率低</p>
<ul>
<li>当需要对某个维度进行范围查询时，需要遍历多个段，并在每个段内执行哈希查询。</li>
<li>范围查询需要将范围拆分成多个子范围，然后分别查询这些子范围，最终合并结果。这增加了查询的复杂性和时间成本。</li>
<li>由于每个段的哈希表是独立的，范围查询不能直接利用哈希值快速定位，而需要逐段检查和合并结果。</li>
</ul>
<blockquote>
<p>多段散列和网格文件其实就是相互补充的，网格文件适用于多维度范围查询；而多段散列则适用于多维度点查询</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="多维数据树结构">多维数据树结构<a href="#多维数据树结构" class="hash-link" aria-label="多维数据树结构的直接链接" title="多维数据树结构的直接链接">​</a></h3>
<p>下面四种结构对于多维数据范围查询和最邻近查询都有用。这四种结构分别是：</p>
<ul>
<li>1、多键索引；</li>
<li>2、kd树；</li>
<li>3、四叉树；</li>
<li>4、R-树；</li>
</ul>
<p>前三种用于点集，R-树用来表示区域集合，也可以用来表示点集。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="多键索引">多键索引<a href="#多键索引" class="hash-link" aria-label="多键索引的直接链接" title="多键索引的直接链接">​</a></h4>
<p>多键索引（Multi-key Index）是一种在数据库中通过多个字段（列）创建的索引结构。这种索引允许数据库在查询时使用多个字段进行高效的搜索操作。多键索引通常用于提高复杂查询的性能，特别是那些涉及多个列的条件查询。</p>
<blockquote>
<p>多键索引类似于innodb中的组合索引</p>
</blockquote>
<div style="text-align:center;width:100%"><img src="/analysis-project/img/data-structure/Multi-keyIndex.png" alt="image" style="max-width:50%;height:auto;display:block;margin:0 auto"></div>
<p><strong>多键索引的优点：</strong></p>
<ul>
<li>提高查询性能：多键索引允许数据库引擎在查询时同时考虑多个列，从而显著提高查询性能。例如，在有大量数据的情况下，单列索引可能不足以提供足够的查询性能，而多键索引可以更好地优化这些查询。</li>
<li>支持复杂查询：多键索引可以优化涉及多个列的复杂查询，比如组合查询（<code>WHERE</code> 子句中包含多个条件）。例如，如果你有一个包含姓名和出生日期的表，你可以创建一个多键索引（<code>name, birthdate</code>）来加速基于姓名和出生日期的查询。</li>
<li>排序和范围查询：多键索引不仅能加速精确匹配的查询，还能加速排序和范围查询。例如，一个基于（<code>name, birthdate</code>）的多键索引可以加速按姓名排序的查询，或者查询特定日期范围内的所有记录。</li>
</ul>
<p><strong>多键索引的缺点：</strong></p>
<ul>
<li>索引大小：多键索引会占用更多的存储空间，因为它们需要存储多个列的数据。索引越多，插入、更新和删除操作的性能可能会受到影响。</li>
<li>选择合适的列顺序：在创建多键索引时，列的顺序非常重要。数据库引擎会按照索引定义的顺序使用列，所以你需要根据查询模式选择合适的列顺序，以最大化查询性能。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="k-d树">K-D树<a href="#k-d树" class="hash-link" aria-label="K-D树的直接链接" title="K-D树的 直接链接">​</a></h4>
<p>K-D树（k-dimensional tree）是一种用于多维空间数据的搜索树结构，特别适合于处理k维空间中的点数据。它是一种二叉树，每个节点表示一个k维空间中的点，K-D树广泛用于多维空间数据的检索，例如最近邻搜索（nearest neighbor search）、范围搜索（range search）和点查找等操作。</p>
<blockquote>
<p><strong>kd树是一个二叉树</strong>。对于表示的多维度数据而言，所有维度的属性 <strong>在层间交替出现</strong>，因此不同层上的属性是不同的。K-D树每层都是一个维度，并且在往下分裂时都是按顺序的循环k个维度；</p>
</blockquote>
<p>举个例子，比如用kd树来表示前面多级索引中年龄-薪资，那么第一层用来表示薪资、第二层用来表示年龄、第三层用来表示薪资、第四层用来表示年龄… 这样依次交替的出现在每一层。</p>
<p>kd树结点的两个特性：</p>
<ul>
<li>1、 <strong>内部结点</strong>：只表示一个属性，基于该属性的划分值（小于该划分值在左子树，大于等于该划分值在右子树），以及指向左子树、右子树的指针；</li>
<li>2、 <strong>叶子结点</strong>：为一个数据块，块中存放尽可能多的记录</li>
</ul>
<p><strong>树的构建</strong>：每次选择一个维度，递归地将数据集分割为两个子集，并按该维度的中位数将数据分为两部分。根节点分割空间的第一个维度，根节点的两个子节点分别分割空间的第二个维度，依此类推，直到达到叶节点。</p>
<p><strong>平衡性</strong>：K-D树的构建方法会导致一个近似平衡的树，但不是严格的平衡树。</p>
<blockquote>
<p>K-D 树的平衡维护是一个复杂的操作，因为它涉及多个维度的平衡。标准的 K-D 树在构建时通过递归地选择中位数分割数据来保持一定程度的平衡，但在动态插入数据时，很难保持严格的平衡。</p>
<p>K-D 树在动态插入时维护严格的平衡较为复杂。对于需要频繁动态插入和删除操作的应用，可以考虑其他适合动态平衡的多维数据结构，如 R 树或 Ball 树</p>
</blockquote>
<p><strong>数据插入：</strong></p>
<ol>
<li>如果叶结点的块有空闲空间：我们就把新的数据点放在那里；</li>
<li>如果叶结点的块空间已满：我们把块分裂成两个，并根据分裂叶结点所在层的相应属性划分叶结点中的内容。最后创建一个新的内部结点：其子节点为分裂得到的新块，并且 <strong>给该内部结点一个与分裂相对应的划分值</strong> 。当无法进行分裂时，我们可以尝试沿另一个维度（属性）进行分裂，或者 <strong>可以使用溢出块</strong>。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="四叉树">四叉树<a href="#四叉树" class="hash-link" aria-label="四叉树的直接链接" title="四叉树的直接链接">​</a></h4>
<p>四叉树（Quadtree）是一种用于表示二维空间中的分层数据结构，常用于处理空间分区问题。四叉树将一个二维空间递归地划分为四个子区域（象限），每个子区域可以进一步细分。这种数据结构非常适合用于表示空间中的点、矩形、线等几何对象，常用于地理信息系统（GIS）、计算机图形学、图像处理和碰撞检测等领域。</p>
<p>四叉树的优势</p>
<ul>
<li><strong>空间效率</strong>：通过分层次划分空间，四叉树可以高效地管理和查询大量二维空间数据。</li>
<li><strong>查询效率</strong>：适合进行快速的范围查询和碰撞检测。</li>
</ul>
<p>四叉树核心概念：</p>
<ol>
<li><strong>节点</strong>：</li>
</ol>
<ul>
<li>四叉树的每个节点表示一个矩形区域，可以包含零个或多个数据点。</li>
<li>如果一个节点的区域包含的点超过某个阈值（如节点的容量），则该节点会分裂成四个子节点。</li>
</ul>
<ol start="2">
<li><strong>分裂</strong>：</li>
</ol>
<ul>
<li>分裂时，将当前节点的区域分成四个相等的象限，每个象限成为一个子节点。</li>
<li>将当前节点中的点分配到相应的子节点中。</li>
</ul>
<ol start="3">
<li><strong>叶节点和内部节点</strong>：</li>
</ol>
<ul>
<li>叶节点：不再分裂的节点，直接包含数据点。</li>
<li>内部节点：已经分裂成四个子节点，不直接包含数据点。</li>
</ul>
<p>示例：还是以上面的表格中的数据为例</p>
<div style="text-align:center;width:100%"><img src="/analysis-project/img/data-structure/QuadTree1.png" alt="image" style="max-width:50%;height:auto;display:block;margin:0 auto"></div>
<p>四叉树，在二维平面上以原点划分4个象限。比如上图的（50，200）点就对应了四个象限，这里约定<strong>一个数据块只能存放两个记录</strong>，当一个象限内的记录多于2个时，我们需要根据记录在空间内的分布情况划分子空间。新找一个原点，比如（25，300），然后同样划分四个象限。</p>
<div style="text-align:center;width:100%"><img src="/analysis-project/img/data-structure/QuadTree2.png" alt="image" style="max-width:50%;height:auto;display:block;margin:0 auto"></div>
<blockquote>
<p>当维度更大之后，出现空指针的情况会越加明显。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="r树">R树<a href="#r树" class="hash-link" aria-label="R树的直接链接" title="R树的直接链接">​</a></h4>
<p>R树（R-tree）是一种多维空间数据结构，专门用于存储和快速检索多维空间中的对象，例如点、线段或者更复杂的几何对象。它是一种广泛应用于空间数据库和GIS（地理信息系统）中的数据结构，能够有效地支持范围查询（range query）和最近邻查询（nearest neighbor query）等操作。</p>
<p><strong>性能和空间利用</strong>：R树的性能高度依赖于其节点的维护和平衡，因此插入和删 除操作可能会导致树的重新平衡和重组，影响性能。</p>
<p><strong>应用场景</strong>：适用于需要高效地存储和检索多维空间数据的场景，如地理信息系统、数据库索引等。</p>
<p>R 树，还有R*树，未完待续...</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Swagger-Ranger/analysis-project/docs/JavaDocs/DSA/data-structure-多维数据索引.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/analysis-project/docs/JavaDocs/DSA/data-structure-位图"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">data-structure-位图</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/analysis-project/docs/JavaDocs/DSA/data-structure-跳表"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">data-structure-跳表</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#多维数据查询" class="table-of-contents__link toc-highlight">多维数据查询</a></li><li><a href="#多维数据结构" class="table-of-contents__link toc-highlight">多维数据结构</a><ul><li><a href="#多维数据散列结构" class="table-of-contents__link toc-highlight">多维数据散列结构</a><ul><li><a href="#网格文件" class="table-of-contents__link toc-highlight">网格文件</a><ul><li><a href="#示例" class="table-of-contents__link toc-highlight">示例</a></li><li><a href="#网格文件的优点" class="table-of-contents__link toc-highlight">网格文件的优点</a></li><li><a href="#网格文件的缺点" class="table-of-contents__link toc-highlight">网格文件的缺点</a></li></ul></li><li><a href="#分段散列" class="table-of-contents__link toc-highlight">分段散列</a></li></ul></li><li><a href="#多维数据树结构" class="table-of-contents__link toc-highlight">多维数据树结构</a><ul><li><a href="#多键索引" class="table-of-contents__link toc-highlight">多键索引</a></li><li><a href="#k-d树" class="table-of-contents__link toc-highlight">K-D树</a></li><li><a href="#四叉树" class="table-of-contents__link toc-highlight">四叉树</a></li><li><a href="#r树" class="table-of-contents__link toc-highlight">R树</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Analysis Project, author liufei32@outlook.com</div></div></div></footer></div>
</body>
</html>